#include <WiFi.h>
#include "ThingSpeak.h"

const char* ssid = "YOUR_WIFI_NAME";   
const char* password = "YOUR_WIFI_PASS"; 

unsigned long myChannelNumber = 1234567;  
const char * myWriteAPIKey = "XYZ123ABC";

WiFiClient  client;

void setup() {
  Serial.begin(115200);
  WiFi.mode(WIFI_STA);
  ThingSpeak.begin(client);
}

void loop() {
  if(WiFi.status() != WL_CONNECTED){
    Serial.print("Connecting to WiFi...");
    while(WiFi.status() != WL_CONNECTED){
      WiFi.begin(ssid, password);
      delay(5000);
    } 
    Serial.println("\nConnected!");
  }
  Simulation Logic) 
  float voltage = random(1250, 1350) / 100.0;
  float current = random(50, 200) / 100.0;
  float trackerPower = voltage * current;
  float fixedPower = trackerPower * 0.7; 
  int temp = random(30, 45);
  int dust = random(10, 180);
  ThingSpeak.setField(1, voltage);
  ThingSpeak.setField(2, current);
  ThingSpeak.setField(3, trackerPower);
  ThingSpeak.setField(4, fixedPower);
  ThingSpeak.setField(5, temp);
  ThingSpeak.setField(6, dust);
  int x = ThingSpeak.writeFields(myChannelNumber, myWriteAPIKey);
  if(x == 200){
    Serial.println("Channel update successful.");
    Serial.print("Voltage: "); Serial.print(voltage);
    Serial.print(" | Power: "); Serial.println(trackerPower);
  }
  else{
    Serial.println("Problem updating channel. HTTP error code " + String(x));
  }
  delay(20000);
}
